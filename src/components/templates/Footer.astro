---
import Section from "@atoms/Section.astro";
import Wrapper from "@atoms/Wrapper2.astro";
import Text from "@atoms/Text.astro";
import List from "@atoms/List.astro";

// --- ON REÇOIT LA PROP 'org' DE MANIÈRE STANDARD ---
const { org = {} } = Astro.props;

const config = {
  showSocial: true,
  showNavPrimary: true,
  showContactInfo: true,
  showLegalInfo: true,
  showAddress: true,
  showGeo: false,
  showCopyright: true,
};
---

<Section as="footer" backgroundColor="accent">
  <Wrapper display="grid" cols={5}>

    {/* ON UTILISE 'org' PARTOUT MAINTENANT */}
    
    {config.showSocial && Array.isArray(org.sameAs) && org.sameAs.length > 0 && (
      <div>
        <Text tag="h4" fontWeight="bold">Réseaux Sociaux</Text>
        <List items={org.sameAs.map(url => `→ ${url}`)} />
      </div>
    )}

    {config.showNavPrimary && org.brand && Array.isArray(org.brand.navlinks) && org.brand.navlinks.length > 0 && (
      <div>
        <Text tag="h4" fontWeight="bold">Navigation principale</Text>
        <List items={org.brand.navlinks.map(link => (link?.name && link?.url) ? `${link.name} → ${link.url}` : null).filter(Boolean)} />
      </div>
    )}

    {config.showContactInfo && (
      <div>
        <Text tag="h4" fontWeight="bold">Contact</Text>
        <List
          items={[
            org.email && `Email : ${org.email}`,
            org.telephone && `Téléphone : ${org.telephone}`,
            org.faxNumber && `Fax : ${org.faxNumber}`,
            org.contactEmail && `Email secondaire : ${org.contactEmail}`,
            org.contactTelephone && `Téléphone secondaire : ${org.contactTelephone}`,
          ].filter(Boolean)}
        />
      </div>
    )}

    {config.showAddress && org.streetAddress && org.postalCode && org.addressLocality && org.addressCountry && (
      <div>
        <Text tag="h4" fontWeight="bold">Adresse</Text>
        <Text tag="p">
          {org.streetAddress}, {org.postalCode} {org.addressLocality}, {org.addressCountry}
        </Text>
      </div>
    )}

    {config.showLegalInfo && (
      <div>
        <Text tag="h4" fontWeight="bold">Mentions légales</Text>
        <List
          items={[
            org.legalName && `Raison sociale : ${org.legalName}`,
            org.taxID && `Tax ID : ${org.taxID}`,
            org.vatID && `TVA : ${org.vatID}`,
            org.isicV4 && `Code ISIC : ${org.isicV4}`,
            org.naics && `Code NAICS : ${org.naics}`,
            org.leiCode && `LEI : ${org.leiCode}`,
            org.duns && `DUNS : ${org.duns}`,
            org.foundingDate && `Créé le : ${new Date(org.foundingDate).toLocaleDateString()}`,
            org.foundingLocation && `Lieu : ${org.foundingLocation}`,
            org.founder && (Array.isArray(org.founder) ? org.founder.length > 0 : org.founder) && `Fondateur : ${Array.isArray(org.founder) ? org.founder.join(", ") : org.founder}`,
          ].filter(Boolean)}
        />
      </div>
    )}

  </Wrapper>

  {config.showCopyright && (org.legalName || org.name) && (
    <Wrapper display="flex" justifyContent="center">
      <Text tag="p" fontSize="13px" textAlign="center">
        © {new Date().getFullYear()} {org.legalName || org.name}. Tous droits réservés.
      </Text>
    </Wrapper>
  )}
</Section>